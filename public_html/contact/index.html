<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="icon" href="favicon.ico">
        <title>Contact Demo</title>
    </head>
    <body>
    <div id="container">
    <h1>Instructions</h1>
    <p>
            Enter contact information here. Data will be stored locally using IndexedDB. Sort 
            column functionality provided by <a href="http://tablesorter.com">tablesorter</a>. 
            You can sort on multiple columns using shift. You can delete information by selecting 
            a row and pressing delete. Multiple rows can be selected using ctl or shift.
            </p>
        <div class="btn-group" id="db-select" data-toggle="buttons">
          <label class="btn btn-primary active">
            <input type="radio" name="options" id="db1" checked> IndexedDB
          </label>
          <label class="btn btn-primary">
            <input type="radio" name="options" id="db2"> MongoDB
          </label>
        </div>
            <div id="contactsDemo">
                <div id="contacts-container">
                    <table>
                    <tr>
                        <th>First Name</th><th>Last Name</th><th>Sex</th><th>Phone</th>
                    </tr>
                    <tbody>
                        <tr>
                        <td><input class="form-control no-radius"></td>
                        <td><input class="form-control no-radius"></td>
                        <td><input class="form-control no-radius" list="sexList"></td>
                        <td><input class="form-control no-radius"></td>
                        <td><button class="btn btn-default no-radius" id="addContact">
                            Add Contact
                        </button></td>
                        <td><button class="btn btn-default no-radius main-blue" id="gen">
                        Generate Contact
                        </button></td>
                        </tr>
                    </tbody>
                    <table>

                    <table id="contactsTable" class="tablesorter-blue tableSelect-default"></table>
                </div>
            </div>

       </div>
       
       <div id="dataList">
        <datalist id="sexList" data-bind="foreach: sexList">
            <option data-bind="attr { value: $data }">
        </datalist>
       
       </div>
            
            
        <link href="/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/table-select.css">
        <link rel="stylesheet" href="/css/main.css">
        <script src="/js/jquery.js"></script>
        <script src="/js/knockout.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        <script src="/js/table.js"></script>
        <script src="/js/table-select.js"></script>
        <script src="contactDB.js"></script>     
        <script src="/tablesorter/js/jquery.tablesorter.js"></script>
        <link rel="stylesheet" href="/tablesorter/css/theme.blue.css">
        
<script>
$(function() {
    if (document.getElementById("db2").checked) {
        mongoDb();
    }
    else {
        indexedDb();
    }
}); 

function mongoDb() {

}

function indexedDb() {
    var data = {
        sexList : ko.observableArray([])
    }
    
    ko.applyBindings(data);
    
    //data.sexList.push('1');

    var divContainer = $("#contacts-container");
    var table = $("#contactsTable");
    var contact = $("#contacts-container input");
    table.contactTable();
    table.bind("contactTableComplete", function(e) {
        table.tablesorter().tableSelect();
        $("html").bind("keypress", function(e) {
            if (e.key == "Del") {
                table.trigger("removeRows");
            }
        });
        data.sexList(table.getSexList());
    });

    $("#gen").bind("click", function(e) {
        e.preventDefault();
        var contact = $.testData.genContact();
        table.trigger("addRec", [contact]);
    });

    $("#addContact").on("click", addContact);
    
    $("#contacts-container").on("keypress", function(e) {
        //console.log(e);
        if (e.key == "Enter") {
            addContact(e);
        }
    });
    
    function addContact(e) {
        table.trigger("addRec", [{
            fname   : contact[0].value,
            lname   : contact[1].value,
            sex     : contact[2].value,
            phone   : contact[3].value
        }]);
        e.preventDefault();
    }
    
    $("#db-select").on("click", function(e) {
        //console.log(e);
    });
}

</script>
</body>

</html>
