/*! russgvsu.com 2014-05-15 */
!function(a){a.contactTable={options:{dbName:"contacts",ver:1.1,tableClass:""}},a.fn.contactTable=function(b){function c(b,c){var d=a("<tr>");return d.append(a("<td>"+b.fname+"</td>")),d.append(a("<td>"+b.lname+"</td>")),d.append(a("<td>"+b.sex+"</td>")),d.append(a("<td>"+b.phone+"</td>")),d.data("id",c),d}var d,e=a.extend({},a.contactTable.options,b),f=e.dbName,g=e.ver,h=indexedDB.open(f,g),i=this;return h.onsuccess=function(a){d=a.target.result,i.trigger("contactDBConnected")},h.onupgradeneeded=function(a){d=a.target.result,d.objectStoreNames.contains("contact")&&d.deleteObjectStore("contact"),d.createObjectStore("contact",{autoIncrement:!0})},i.bind("contactDBConnected",function(){var b=a("<thead>");b.append(a("<tr><th>First Name</th><th>Last Name</th><th>Sex</th><th>Phone</th></tr>")),i.append(b);var e=a("<tbody>");i.append(e);var f=d.transaction(["contact"]),g=f.objectStore("contact").openCursor(IDBKeyRange.lowerBound(0));f.oncomplete=function(){i.trigger("contactTableComplete")},g.onsuccess=function(a){var b=a.target.result;b&&(e.append(c(b.value,b.key)),b.continue())}}),i.bind("addRec",function(a,b){i.find("tbody").append(c(b));var e=d.transaction(["contact"],"readwrite"),f=e.objectStore("contact"),g=f.put(b);g.onsuccess=function(){},g.onerror=function(a){console.log("Error",a)}}),i.bind("removeRec",function(a,b){var c=d.transaction(["contact"],"readwrite"),e=c.objectStore("contact"),f=e.delete(b);f.onsuccess=function(){console.log("successfully removed record",b)},f.onerror=function(a){console.log("Error removing",a)}}),this}}(jQuery);